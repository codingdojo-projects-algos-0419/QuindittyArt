{% extends './layout.html' %}
{% block title %}{{post['title']}}{% endblock %}
{% block body %}
<div class="wrapper">
        {% if user in session %}
        <div class='header'>
            <h5>Welcome {{user['username']}}!</h5>
            <div class="header_right">
                <a href="{{ url_for('users:edit', user_id=user['id'])}}">My Account</a>
                <a href="{{url_for('users:logout')}}">Logout</a>
            </div><br>
        </div>
    {% endif %}
    {% else %}
        <div class='header'>
            <div class="header_right">
                <a href="{{url_for('users:login')}}">Login</a>
            </div><br>      
        </div>
        {% endelse %}
    <div class="main">
        <h5>{{post['title']}}</h5>
        <div class="post">
            <p>{{post['content']}}</p><br>
            <p>{{post['text']}}</p>
            <p>{{post.likes()}}likes</p>
            {% if post.not_liked %}
                <a href="post/{{post['id']}}/like" class="button">Like</a></td>
            {% endif %}
            {% if user['admin_lvl'] %}
                <p><a href="posts/{{post['id']}}/delete">Delete</a></p>
            {% endif %}
        </div>
        <div class='comments'>
            <form action="posts/<post_id>/comment" method="post">
                <input type="text" name='content' required>
                <input type="submit" value="comment">
            </form>
            {% for comment in comments %}
                <div class='comment'>
                    <p>{{comment.user.username}} says:</p>
                    <p>{{comment.content}}</p>
                    {% if user['admin_lvl'] == 2 or user['id'] == comment['user_id'] %}
                        <a href="comment/{{comment['id']}}/delete">Delete</a>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    </div>  
</div>

{% endblock %}